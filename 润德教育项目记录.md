# 润德教育项目记录

> 本文件专门记录在 Telegram 群聊 `[润德教育讨论群]` 中讨论的润德教育相关工作内容。

---

## ⚠️ 重要规则：测试环境访问规范

> **强制要求**：所有测试环境的访问必须通过 **Nginx 反向代理**，禁止直接访问前端或后端容器。

### 🚫 禁止行为
- ❌ 直接访问前端容器 (如 `localhost:3000`)
- ❌ 直接访问后端API (如 `localhost:3001`)
- ❌ 使用 `docker exec` 进入容器进行调试

### ✅ 正确做法
- ✅ 通过 Nginx 访问：`http://test.rundeedu.com` (或配置的域名)
- ✅ 前端静态资源：`http://test.rundeedu.com/`
- ✅ 后端API：`http://test.rundeedu.com/api/`

### 📋 原因
1. **一致性**：生产环境通过 Nginx 访问，测试环境必须一致
2. **Cookie/Session**：跨域访问会导致认证问题
3. **负载均衡**：Nginx 配置了负载策略，直接访问会绕过
4. **日志追踪**：所有请求经过 Nginx，便于问题排查

### 🔧 本地开发例外
- 本地开发可以使用 `localhost:3000` (热重载调试)
- 但功能测试和联调必须走 Nginx

---

## 📋 任务清单

### ✅ 已完成

| 日期 | 任务 | 说明 |
|------|------|------|
| 2026-01-31 | 12月三方平台流水核对 | 79,631行数据，43,956条存在 |
| 2026-01-31 | 11月三方平台流水核对 | 28,964/28,967条匹配 |
| 2026-01-31 | 3.0数据清理 | 9万+条重复记录已修复 |
| 2026-01-31 | 订单平衡校验脚本 | `docs/查询sql/订单收入平衡校验.sql` |
| 2026-01-31 | 跨月验证差异分析 | 发现36,181个订单缺失月份数据 |
| 2026-02-01 | 僵尸订单问题通知团队 | 等待团队检查原因并补数据 |
| 2026-02-02 | 代码推送 | 推送3个文件到 `refactor/optimize-sql-config` 分支 |

---

### ⏳ 待完成 / 进行中

| 优先级 | 任务 | 状态 | 说明 |
|--------|------|------|------|
| 🔴 高 | 财务数据与清洗库金额核对 | ⚠️ 未解决 | 尚未找到有效核对方法 |
| 🟡 中 | 僵尸订单补数据 | ⏳ 待响应 | 等待团队检查原因并补数据 |

---

## 📊 发现的问题

### 僵尸订单问题
- **2022年之前**有余额的僵尸订单: 6,102个
- **2023年之前**有余额的僵尸订单: 38,372个
- **2024年之前**有余额的僵尸订单: 248,211个

### 跨月差异
- **2024-01差异**: 375,162.54元
- **原因**: 36,181个订单在2023-12月有余额，但2024-01月没有记录

---

## 📁 相关文件

- 项目路径: `/Volumes/SanDisk2T/dv-codeBase/RunDeEdu/`
- 核对脚本: `workspace/rundeedu_scripts.md`
- 平衡校验SQL: `docs/查询sql/订单收入平衡校验.sql`
- 远程仓库: `git@github.com:zst566/RunDeEDU.RevenueRecognition.git`

---

## 💬 讨论要点

- **2026-02-01**: 在润德教育研发群通知团队关于僵尸订单问题，要求检查原因并补数据
- **2026-02-02**: 完成代码推送，推送分支 `refactor/optimize-sql-config`

---
