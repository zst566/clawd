# TASKS.md - 工作任务总览

> **⚠️ 重要规范：所有工作任务、工作安排、提醒事项均记录在此文件**
> 
> - 不再使用 memory/ 记录任务（仅记录每日流水账）
> - 新增任务 → 立即更新此文件
> - 每日工作 → 每天整理后更新此文件
> - 定期检查 → 确保无遗漏
> 
> 创建时间：2026-01-29
> 最后更新：2026-02-27

---

## 一、关于我

- **名字**: 小d 🤖
- **角色**: AI开发搭档，实用派
- **工作模式**: 每个新会话自动读取此文件，了解项目全貌

---

## 二、项目概览

### 茂名·交投-文旅平台

| 项目 | 信息 |
|------|------|
| **技术栈** | Vue 3 + Vite + Element Plus |
| **后端** | Node.js + Prisma + MySQL |
| **Deadline** | 2026-02-14 正式上线 |
| **项目路径** | `/Volumes/SanDisk2T/dv-codeBase/茂名·交投-文旅平台` |
| **合同状态** | ✅ 已签订，首款已收，发票已开（2026-01-30） |

### 润德教育 - 收入摊销系统

| 项目 | 信息 |
|------|------|
| **项目路径** | `/Volumes/SanDisk2T/dv-codeBase/RunDeEdu/` |
| **主要脚本** | `batch_order_chain_query.py`, `extract_full_order_chain.py` |
| **远程仓库** | `git@github.com:zst566/RunDeEDU.RevenueRecognition.git` |

### 润德教育 Dashboard 优化项目 🆕

| 项目 | 信息 |
|------|------|
| **项目路径** | `/Volumes/SanDisk2T/dv-codeBase/RunDeEdu/revenue-recognition-management/` |
| **前端路径** | `frontend-pc/src/views/Dashboard.vue` (1540行，待拆分) |
| **后端路径** | `backend-node/src/services/dashboardService.js` (1310行，待拆分) |
| **项目文档** | `~/clawd/agents/main/workspace/rundeedu-dashboard-optimization/` |
| **启动时间** | 2026-02-27 21:21 |
| **当前阶段** | **阶段3 - 后端代码审查** |
| **状态** | 🟡 进行中 |

**项目目标**：
1. 前端 Dashboard.vue 模块化拆分 (1540行 → 多个小组件)
2. 后端 dashboardService.js 模块化拆分 (1310行 → 多个Service)
3. 性能优化、安全加固、最佳实践

**团队配置**：
| 角色 | Agent | 当前任务 | 状态 |
|------|-------|----------|------|
| 项目经理 | 小d | 协调、验收 | ✅ 活跃 |
| 后端/前端开发 | @码匠 | **阶段4前端设计** | **⏳ 当前任务** |
| 数据顾问 | @zhou_data_bot | 数据模型评审 | ✅ 已完成 |
| 安全审查 | @guardian | 后端代码安全审查 | ✅ 已完成 |
| 质量审查 | @inspector | 后端代码质量审查 | ✅ 已完成 |

**定时检查机制**：
- **频率**: 每5分钟（有明确任务时）
- **Cron ID**: `dashboard-optimization-status-check`
- **任务**: 检查 Agent 状态、阻塞问题
- **状态文件**: `rundeedu-dashboard-optimization/STATUS.md`

**项目流程** (10阶段)：
1. ✅ 方案评审 - @zhou_data_bot 已完成
2. ✅ **后端实现 - @码匠 已完成 (P2-P4)**
3. ✅ **后端代码审查 - @guardian/@inspector 已完成**
4. 🔄 **前端设计细化 [当前]** - 等待开始
5. ⏳ 前端实现 (@码匠)
6. ⏳ 前端代码审查
7. ⏳ 测试设计
8. ⏳ 测试执行
9. ⏳ 集成测试
10. ⏳ 最终验收

**关键文档**：
- `DESIGN.md` - 架构设计
- `PROJECT_PLAN.md` - 完整项目流程
- `STATUS.md` - 实时状态跟踪
- `constants/dashboard.js` - 前端常量

---

## 三、🔴 紧急任务（本周完成）

### 1. 茂名文旅小程序注册备案
- **截止**: 本周内
- **说明**: 小程序上线前必须完成备案
- **状态**: ⏳ 待进行

### 2. 润德教育财务数据核对
- **问题**: 财务订单有数据但清洗库缺少数据
- **原因**: 基础数据同步错误
- **需要**: 检查并补齐缺失数据
- **状态**: 🔴 待处理

### 3. 越秀区质监局投诉 ✅ 已完成
- **截止**: 2026年2月2日（下周一）
- **说明**: 整合意见反馈函，回复越秀区市监局
- **完成情况**:
  - ✅ 意见函已反馈
  - ✅ 已跟客户联系
  - ✅ 未完成的结果已回复越秀区市监局（北京街）

---

## 四、🟠 重要任务（2月上旬）

### 4. 茂名文旅环境配置
- **时间**: 2月1-3日
- **内容**: 买服务器 + 数据库 + 环境搭建
- **状态**: ⏳ 待进行

### 5. 茂名文旅前端+后端开发
- **时间**: 2月3-8日
- **内容**: 按设计完成所有功能开发
- **状态**: ⏳ 待进行

### 6. 润德教育1月数据准备
- **时间**: 2月1日
- **状态**: ⏳ 待安排

### 7. 3.0系统增量同步计算
- **时间**: 2月3日提醒
- **状态**: ⏳ 待安排

---

## 五、🟡 中等优先级

### 8. 山西培训平台小程序设计
- **预算**: 39k
- **功能**: 客户积分 + 积分兑换功能
- **状态**: ⏳ 待设计

### 9. PC端页面与后端API联调
- **内容**: Banner管理页面对接
- **状态**: ⏳ 待进行

### 10. 图片上传功能
- **项目**: 茂名文旅
- **状态**: ⏳ 待实现

---

## 六、🐛 Bug修复

### 11. 流云阁手机端核销问题 🔴高优先级
- **问题**: PC端导出时标签改变、计价异常
- **用户反馈**: 已发例子，需排查数据导出逻辑
- **严重程度**: 高

### 12. 流云阁教师优惠功能 🟡
- **功能**: 增加"教师优惠10元"固定金额标签
- **用途**: 核销时修改门票价格
- **状态**: ⏳ 待安排时间

---

## 七、时间线（里程碑）

### 🔴 紧急（本周）
| 日期 | 事项 | 说明 |
|------|------|------|
| **2月14日** | 🎯 **茂名文旅正式上线** | 最终Deadline |

### 🟠 重要（2月上旬）
| 日期 | 事项 |
|------|------|
| 2月1日 | 润德教育1月数据准备 |
| 2月1-3日 | 茂名文旅环境配置 |
| 2月3-8日 | 茂名文旅前端+后端开发 |
| 2月3日 | 提醒3.0系统增量同步计算 |

---

## 🔴 紧急遗留问题 (2026-03-01)

### 1. DB配置后台页面无法访问
- **时间**: 昨天遗留，今日处理
- **问题**: 有两个页面无法访问，原因不明
- **优先级**: 🔴 高
- **状态**: ⏳ 待排查

### 2. ✅ 鹿状元网站已恢复
- **时间**: 昨天遗留，今日已解决 (13:27)
- **问题**: 网站无法访问
- **根因**: 阿里云余额不足 → 负载均衡扣费失败停机 → 无法转发请求
- **解决方案**: 充值 1000 元
- **状态**: ✅ 已解决

---

## 八、长期待办清单

### 茂名文旅平台
- [ ] 小程序注册备案
- [ ] 买服务器 + 数据库
- [ ] 环境配置
- [ ] 前端开发（按新设计）
- [ ] 后端API开发
- [ ] 图片上传功能
- [ ] PC端页面联调
- [ ] 功能测试
- [ ] Bug修复
- [ ] 容器打包
- [ ] 预上线测试
- [ ] **2月14日正式上线**

### 其他项目
- [ ] **山西培训平台** - 客户积分功能 + 积分兑换入口设计 | ⏳ 待设计 |
  - 沟通已完成，待设计完成后落实合同（预算39k） |
  - 需修改小程序端设计，添加积分和兑换模块 |
- [x] **润德教育3.0数据清理** - ✅ **已修复**
  - 问题：9万+条重复记录
  - 处理：删除重复记录后重新计算摊销数据
- [ ] **润德教育12月财务核对** - 🔴 **发现严重问题**：财务订单有数据但清洗库缺少数据，基础数据同步错误导致，需继续检查确定原因并补齐数据
- [x] **越秀区质监局投诉** - ✅ 已完成
- [ ] **润德培训财务报表梳理** - 4年数据，按省校分校方式 | ⏳ 待安排
- [ ] 润德教育1月数据准备 | ⏳ 待安排
- [ ] 3.0系统增量同步计算 | ⏳ 待安排
- [ ] **🔴 流云阁手机端核销问题** - 标签改变和计价异常（PC端导出时）
- [ ] **🟡 流云阁教师优惠功能** - 增加"教师优惠10元"固定金额标签，核销时修改门票价格 | ⏳ 待安排时间

---

## 九、代码位置速查

| 类型 | 路径 |
|------|------|
| 移动端页面 | `apps/mobile-h5/src/views/v2/` |
| PC端页面 | `apps/pc-admin/src/views/` |
| 后端路由（PC） | `apps/backend/src/routes/pc/` |
| 后端路由（移动端） | `apps/backend/src/routes/mobile/` |
| 数据库Schema | `apps/backend/prisma/schema.prisma` |
| API设计文档 | `茂名交投-API设计.md` |

---

## 十、附录：已完成页面清单

### 移动端V2页面（18个）
```
src/views/v2/
├── home/Home.vue                    # 首页
├── attractions/
│   ├── List.vue                     # 景点列表
│   └── Detail.vue                   # 景点详情
├── homestays/
│   ├── List.vue                     # 民宿列表
│   └── Detail.vue                   # 民宿详情
├── carpool/
│   ├── Create.vue                   # 发起拼车
│   ├── Pending.vue                  # 等待匹配
│   ├── PayWait.vue                  # 等待支付
│   └── Success.vue                  # 支付成功
├── food/List.vue                    # 吃在信宜
├── shop/List.vue                    # 特产好礼
├── consult/Index.vue                # 人工咨询
├── feedback/Index.vue               # 投诉建议
├── articles/
│   ├── List.vue                     # 资讯列表
│   └── Detail.vue                   # 资讯详情
└── recommend/Index.vue              # 为你推荐
```

### PC端管理页面（10个）
```
src/views/
├── dashboard/Index.vue              # 首页仪表盘
├── home-config/Index.vue            # 首页配置
├── orders/Index.vue                 # 订单管理
├── carpools/Index.vue               # 拼车订单
├── carpool-route/
│   ├── RouteConfig.vue              # 线路配置
│   └── vehicle/VehicleConfig.vue    # 车辆配置
├── users/Index.vue                  # 用户管理
├── attractions/Index.vue            # 景点管理
├── homestays/Index.vue              # 民宿管理
└── articles/Index.vue               # 资讯管理
```

---

## 十一、更新记录

| 日期 | 更新内容 | 操作人 |
|------|----------|--------|
| 2026-01-29 | 创建TASKS.md，整理1月28-29日工作记录 | 小d |
| 2026-01-30 | 茂名文旅合同已签订，首款已收，发票已开 | 小d |
| 2026-01-30 | 新增润德教育3.0数据清理任务：9万+异常记录 | 小d |
| 2026-01-30 | 润德教育12月财务核对更新：发现财务数据问题 | 小d |
| 2026-02-02 | 越秀区市监局投诉处理完成 | 小d |
| 2026-02-02 | 润德教育僵尸订单检查功能已完成 | 小d |
| 2026-02-27 | 整合根目录TASKS.md，更新任务状态 | 小d |
| 2026-02-27 | **新增：润德教育 Dashboard 优化项目** - 前后端模块化拆分，5个Agent协作，每5分钟定时检查 | 小d |

---

## ✅ 已完成（归档）

- **润德教育PC端僵尸订单检查功能** ✅（2026-02-02）
  - 在数据概览页面顶部增加"🧟 僵尸订单检查"按钮
  - 支持一键扫描数据库中的僵尸订单
  - 按年份统计僵尸订单数量和未确认余额
  - 支持下载僵尸订单列表（CSV格式）
  - 后端API: `/api/zombie-orders/scan`, `/api/zombie-orders/download`

- 茂名文旅合同签订（2026-01-30）
- 润德教育3.0数据清理（2026-01-30）
- 山西培训平台方案沟通（2026-01-29）
- 广电奇安信验证码登录问题（2026-01-28）
