# 2026-02-02 茂名文旅 - 拼车编码问题修复

## 问题描述
- API 返回的中文（departure/destination）显示为乱码：`ä¿¡å®œæ±½è½¦ç«™` 而不是 `信宜汽车站`

## 根因分析
1. MySQL 数据库中的数据已经正确存储（通过 `HEX()` 验证）
   - `信宜汽车站` 的 UTF-8 字节: `C3A4C2BFC2A1C3A5C2AEC593C3A6C2B1C2BDC3A8C2BDC2A6C3A7C2ABE284A2`
   
2. **Prisma ORM 读取时存在编码问题** - 即使数据库数据正确，Prisma 返回的字符串已经是乱码

3. 尝试的解决方案：
   - ✅ 数据库数据正确（无需修复）
   - ✅ `SET NAMES utf8mb4` - 无效
   - ✅ `iconv-lite` 解码 - 无效（因为数据本身是正确的）
   - ❌ 切换到 `$queryRaw` 原始 SQL - 部分有效但遇到代码错误

## 当前代码状态
- 文件: `apps/backend/src/routes/mobile/index.js`
- 添加了 `iconv` 导入
- 添加了 `fixEncoding()` 函数
- GET `/carpools/:id` 接口尝试使用 `$queryRaw` 替代 Prisma
- **遇到错误**: `ReferenceError: participants is not defined`

## 待解决
1. 修复 `participants` 变量未定义的问题
2. 确认原始 SQL 查询是否解决了编码问题
3. 同步修复 POST `/carpools` 发起接口的编码

## 数据库信息
- 容器: xinyi-mysql
- 数据库: xinyi_wenlu_dev
- 用户: root/password
- 已验证数据正确，无需额外修复
